syntax = "proto3";

package Protocol;
option csharp_namespace = "Google.Protobuf.Protocol";

enum MsgId {
    // 로그인
    C_LOG_IN = 0;
    S_LOG_IN = 1;
    C_CREATE_ACCOUNT = 2;
    S_CREATE_ACCOUNT = 3;
    C_CHECK_SAVE_DATA = 4;
    S_CHECK_SAVE_DATA = 5;
    C_LOAD_GAME_DATA = 6;


  // 게임 씬
  S_ENTER_GAME = 111;
  C_EXIT_GAME = 1111;
  C_ENTER_ROOM = 100;
  S_ENTER_ROOM = 110;
  S_LEAVE_ROOM = 333;
  C_ENTER_POKEMON_BATTLE_SCENE = 42;
  S_ENTER_POKEMON_BATTLE_SCENE = 43;
  S_MEET_WILD_POKEMON = 150;
  S_GET_NPC_TALK = 170;
  S_GET_TRAINER_TALK = 171;
  C_SHOP_ITEM_LIST = 180;
  S_SHOP_ITEM_LIST = 190;
  C_GET_ITEM_COUNT = 700;
  S_GET_ITEM_COUNT = 710;
  C_BUY_ITEM = 720;
  S_BUY_ITEM = 730;
  C_SELL_ITEM = 740;
  S_SELL_ITEM = 750;
  C_RESTORE_POKEMON = 760;
  S_RESTORE_POKEMON = 770;
  C_FINISH_NPC_TALK = 780;
  C_SAVE_GAME_DATA = 712;
  S_SAVE_GAME_DATA = 713;

  // 포켓몬 리스트 씬
  C_USE_ITEM_IN_LIST_SCENE = 820;
  S_USE_ITEM_IN_LIST_SCENE = 830;

  // 트레이너 배틀 씬
  C_ENTER_TRAINER_BATTLE = 80;
  S_ENTER_TRAINER_BATTLE = 81;
  C_CHECK_AVAILABLE_MOVE = 82;
  S_CHECK_AVAILABLE_MOVE = 83;
  C_SEND_ACTION = 84;
  S_SEND_ACTION = 85;
  C_REQUEST_NEXT_BATTLE_ACTION = 86;
  C_CHECK_AVAILABLE_POKEMON = 88;
  S_CHECK_AVAILABLE_POKEMON = 89;
  C_SURRENDER_TRAINER_BATTLE = 92;
  S_SURRENDER_TRAINER_BATTLE = 93;

  // 포켓몬 교환 씬
  C_ENTER_POKEMON_EXCHANGE_SCENE = 400;
  S_ENTER_POKEMON_EXCHANGE_SCENE = 410;
  C_MOVE_EXCHANGE_CURSOR = 420;
  S_MOVE_EXCHANGE_CURSOR = 430;
  C_CHOOSE_EXCHANGE_POKEMON = 440;
  S_CHOOSE_EXCHANGE_POKEMON = 450;
  C_FINAL_ANSWER_TO_EXCHANGE = 460;
  S_FINAL_ANSWER_TO_EXCHANGE = 470;
  C_EXIT_POKEMON_EXCHANGE_SCENE = 480;
  S_EXIT_POKEMON_EXCHANGE_SCENE = 490;

  S_SPAWN = 544;
  S_DESPAWN = 655;
  C_MOVE = 7;
  S_MOVE = 8;
  C_CREATE_PLAYER = 9;
  S_SEND_TALK = 15;
  S_RECEIVE_TALK = 16;
  C_SWITCH_POKEMON = 12;
  
  // 배틀 씬
  C_REQUEST_DATA_BY_ID = 60;
  C_PROCESS_TURN = 310;
  S_PROCESS_TURN = 320;
  S_SWITCH_BATTLE_POKEMON = 31;
  S_GET_ENEMY_POKEMON_EXP = 61;
  S_CHECK_AND_APPLY_REMAINED_EXP = 62;
  C_FORGET_AND_LEARN_NEW_MOVE = 620;
  S_FORGET_AND_LEARN_NEW_MOVE = 630;
  S_CHECK_AVAILABLE_BATTLE_POKEMON = 350;
  S_SEND_OPPONENT_NEXT_POKEMON = 391;
  S_ESCAPE_FROM_WILD_POKEMON = 63;
  S_CHECK_POKEMON_EVOLUTION = 330;
  C_GET_REWARD_INFO = 341;
  S_GET_REWARD_INFO = 342;
  
  C_RETURN_GAME = 433;
  S_RETURN_GAME = 443;

  C_PLAYER_TALK = 70;
  S_SEND_TALK_REQUEST = 71;

  // 포켓몬 진화 씬
  C_POKEMON_EVOLUTION = 520;
  S_POKEMON_EVOLUTION = 530;
}

// 로그인
message C_LogIn {
    string id = 1;
    string password = 2;
}

message S_LogIn {
    LogInResultType logInResult = 1;
}

message C_CreateAccount
{
    string id = 1;
    string password = 2;
}

message S_CreateAccount
{
    bool isSuccess = 1;
}

enum LogInResultType
{
    Success = 0;
    IdError = 1;
    PassswordError = 2;
}

message C_CheckSaveData
{
    string id = 1;
}

message S_CheckSaveData
{
    string foundDataId = 1;
    bool isDataFound = 2;
}

message C_LoadGameData
{
    string accountId = 1;
}



// 게임 씬
enum RoomType {
    None = 0;
    Map = 1;
    PokemonCenter = 2;
    FriendlyShop = 3;
}

message S_EnterGame {
}

message C_ExitGame {
	int32 objectId = 1;
}

message C_EnterRoom {
    int32 playerId = 1;
    int32 prevRoomId = 2;
    RoomType prevRoomType = 3;
}

message S_EnterRoom {
    PlayerInfo playerInfo = 1;
    int32 roomId = 2;
    RoomType roomType = 3;
    repeated NPCInfo npcInfos = 4;
}

message S_LeaveRoom {
}

message C_ReturnGame {
    int32 playerId = 1;
}

message S_ReturnGame {
    repeated ObjectInfo otherPlayers = 1;
}

message S_Spawn {
    repeated OtherPlayerInfo otherPlayers = 1;
}

message S_Despawn {
    repeated int32 objectIds = 1;
}

message C_Move {
    int32 objectId = 1;
    PositionInfo posInfo = 2;
}

message S_Move {
    int32 objectId = 1;
    PositionInfo posInfo = 2;
}

message C_CreatePlayer {
    string userId = 1;
    PlayerGender gender = 2;
    string name = 3;
}

message S_SendTalk
{
    OtherPlayerInfo otherPlayerInfo = 1;
}

message S_ReceiveTalk
{
    OtherPlayerInfo otherPlayerInfo = 1;
}

message S_GetNpcTalk
{
    int32 npcId = 1;
    repeated string scripts = 2;
}

message S_GetTrainerTalk
{
    int32 npcId = 1;
    repeated string scripts = 2;
    bool canBattle = 3;
}

message C_ShopItemList
{
    int32 playerId = 1;
}

message S_ShopItemList
{
    repeated ItemSummary shopItemSums = 1;
}

message C_GetItemCount
{
    int32 playerId = 1;
    ItemCategory itemCategory = 2;
    string itemName = 3;
}

message S_GetItemCount
{
    int32 itemCount = 1;
    int32 money = 2;
}

message C_BuyItem
{
    int32 playerId = 1;
    int32 itemQuantity = 2;
    int32 itemIdx = 3;
}

message S_BuyItem
{
    bool isBuy = 1;
    int32 money = 2;
    int32 foundItemIdx = 3;
    int32 foundItemCnt = 4;
    bool createNewIdx = 5;
    int32 newItemCnt = 6;
}

message C_SellItem
{
    int32 playerId = 1;
    ItemCategory ItemCategory = 2;
    int32 itemQuantity = 3;
    int32 itemIdx = 4;
}

message S_SellItem
{
    int32 money = 1;
    int32 itemQuantity = 2;
}

message C_RestorePokemon
{
    int32 playerId = 1;
}

message S_RestorePokemon
{
    int32 pokemonCount = 1;
}

message C_FinishNpcTalk
{
    int32 playerId = 1;
}

message C_SwitchPokemon {
    int32 ownerId = 1;
    int32 pokemonFromIdx = 2;
    int32 pokemonToIdx = 3;
}

message S_MeetWildPokemon
{
    int32 roomId = 1;
    int32 bushNum = 2;
}

message C_SaveGameData
{
    string accountId = 1;
    int32 playerId = 2;
}

message S_SaveGameData
{
    bool isSuccess = 1;
}




// 포켓몬 리스트 씬
message C_UseItemInListScene
{
    int32 playerId = 1;
    int32 targetPokemonOrder = 2;
    ItemCategory usedItemCategory = 3;
    int32 usedItemOrder = 4;
}

message S_UseItemInListScene
{
    ItemSummary itemSum = 1;
    PokemonSummary targetPokemonSum = 2;
    ItemUseResult itemUseResult = 3;
    int32 usedItemOrder = 4;
}

message ItemUseResult
{
    oneof specialInfo
    {
        HPRecoveryItemUseResult hpRecoveryItemUseResult = 8;
        PokeBallUseResult pokeBallUseResult = 9;
    }
}

message HPRecoveryItemUseResult
{
    int32 realRecoveryAmt = 1;
}

message PokeBallUseResult
{
    bool didCatch = 1;
}

message ItemSummary
{
    ItemCategory itemCategory = 1;
    string itemName = 2;
    string itemDescription = 3;
    int32 itemCnt = 4;
    int32 itemPrice = 5;
    repeated CreatureState useState = 6;
    string afterUseScript = 7;
}




// 배틀 씬
message C_EnterPokemonBattleScene
{
    int32 playerId = 1;
    int32 locationNum = 2;
    int32 bushNum = 3;
}

message S_EnterPokemonBattleScene
{
    int32 myFirstBattlePokemonOrder = 1;
    PokemonSummary enemyPokemonSum = 2;
    NPCInfo npcInfo = 3;
}

message C_RequestDataById
{
    int32 playerId = 1;
    RequestType requestType = 2;
}

enum RequestType
{
    CHECK_OBJECT_IN_MAP = 0;
    GET_ENEMY_POKEMON_EXP = 2;
    CHECK_AND_APPLY_REMAINED_EXP = 3;
    ESCAPE_FROM_WILD_POKEMON = 4;
    CHECK_AVAILABLE_BATTLE_POKEMON = 5;
    CHECK_POKEMON_EVOLUTION = 6;
    SEND_OPPONENT_NEXT_POKEMON = 7;
}

message C_ProcessTurn
{
    int32 playerId = 1;
    int32 moveOrder = 2;
}

message S_ProcessTurn
{
    bool isMyPokemon = 9;
    int32 usedMoveOrder = 1;
    PokemonMoveSummary usedMoveSum = 2;
    PokemonSummary attackPokemonSum = 3;
    PokemonSummary defensePokemonSum = 4;
    bool _isHit = 5;
    float typeEffectiveness = 6;
    bool isCriticalHit = 7;
    bool isTurnFinish = 8;
}

message S_GetEnemyPokemonExp
{
    string expPokemonName = 1;
    int32 exp = 2;
}

message S_CheckAndApplyRemainedExp
{
    int32 finalExp = 1;
    PokemonSummary expPokemonSum = 2;
    LevelUpStatusDiff statDiff = 3;
    PokemonMoveSummary newMoveSum = 4;
    int32 expPokemonOrder = 5;
    bool isExpFinish = 6;
}

message C_ForgetAndLearnNewMove
{
    int32 playerId = 1;
    int32 forgetMoveOrder = 2;
}

message S_ForgetAndLearnNewMove
{
    string prevMoveName = 1;
    string newMoveName = 2;
}

message S_EscapeFromWildPokemon
{
    bool canEscape = 1;
}

message S_CheckAvailableBattlePokemon
{
    bool canFight = 1;
}

message S_SendOpponentNextPokemon
{
    PokemonSummary opponentPokemonSum = 1;
}

message S_CheckPokemonEvolution
{
    string evolutionPokemonName = 1;
    int32 evolvePokemonIdx = 2;
}

message C_GetRewardInfo
{
    int32 playerId = 1;
}

message S_GetRewardInfo
{
    int32 money = 1;
    repeated string afterBattleScripts = 2;
}

message S_SwitchBattlePokemon
{
    PokemonSummary prevPokemonSum = 1;
}




// 플레이어 배틀 씬
message C_EnterTrainerBattle
{
    int32 playerId = 1;
}

message S_EnterTrainerBattle
{
    PlayerInfo myPlayerInfo = 1;
    repeated OtherPlayerInfo otherPlayerInfos = 2;
    repeated PokemonSummary otherPokemonSums = 3;
    int32 firstBattlePokemonOrder = 4;
}

message C_CheckAvailableMove
{
    int32 playerId = 1;
}

message S_CheckAvailableMove
{
    bool canUseMove = 2;
}

message C_SendAction
{
    int32 playerId = 1;
    oneof specialInfo
    {
        UseNoPPMove useNoPPMove = 2;
        UseMove useMove = 3;
        // ReadyForResponse readyForResponse = 4;
        SwitchBattlePokemon switchBattlePokemon = 5;
        FinishBattle finishBattle = 6;
    }
}

message UseNoPPMove
{
}

message UseMove
{
    int32 selectedMoveOrder = 1;
}

message ReadyForResponse
{
}

message SwitchBattlePokemon
{
    int32 fromIdx = 1;
    int32 toIdx = 2;
}

message FinishBattle
{
}

message S_SendAction
{
    int32 turnPlayerId = 1;
    bool isTurnFinish = 2;
    oneof specialInfo
    {
        UseMoveResult useMoveResult = 3;
        SwitchBattlePokemonResult switchPokemonResult = 4;
        FinishBattleResult finishBattleResult = 5;
    }
}

message UseMoveResult
{
    int32 usedMoveOrder = 1;
    PokemonMoveSummary usedMoveSum = 2;
    PokemonSummary attackPokemonSum = 3;
    PokemonSummary defensePokemonSum = 4;
    bool _isHit = 5;
    float typeEffectiveness = 6;
    bool isCriticalHit = 7;
}

message SwitchBattlePokemonResult
{
    PokemonSummary prevPokemonSum = 1;
    PokemonSummary newPokemonSum = 2;
}

message FinishBattleResult
{
    int32 winPlayerId = 1;
    int32 losePlayerId = 2;
}

message C_RequestNextBattleAction
{
    int32 playerId = 1;
}

message C_CheckAvailablePokemon
{
    int32 playerId = 1;
}

message S_CheckAvailablePokemon
{
    bool canFight = 1;
}

message C_SurrenderTrainerBattle
{
    int32 playerId = 1;
}

message S_SurrenderTrainerBattle
{
    int32 surrenderPlayerId = 1;
}




// 포켓몬 교환 씬
message C_EnterPokemonExchangeScene
{
    int32 playerId = 1;
}

message S_EnterPokemonExchangeScene
{
    PlayerInfo playerInfo = 1;
    OtherPlayerInfo otherPlayerInfo = 2;
    repeated PokemonSummary myPokemonSums = 3;
    repeated PokemonSummary otherPokemonSums = 4;
    ExchangeCursorPos myCursorPos = 5;
    ExchangeCursorPos otherCursorPos = 6;
    PokemonSummary otherPokemonSum = 7;
}

message C_ChooseExchangePokemon
{
    int32 playerId = 1;
    int32 pokemonOrder = 2;
}

message S_ChooseExchangePokemon
{
    PokemonSummary otherPokemonSum = 1;
}

message C_FinalAnswerToExchange
{
    int32 playerId = 1;
    bool finalAnswer = 2;
}

message S_FinalAnswerToExchange
{
    PokemonSummary myPokemonSum = 1;
    PokemonSummary otherPokemonSum = 2;
}

message C_MoveExchangeCursor
{
    int32 playerId = 1;
    int32 x = 2;
    int32 y = 3;
}

message S_MoveExchangeCursor
{
    int32 x = 1;
    int32 y = 2;
}

message C_ExitPokemonExchangeScene
{
    int32 playerId = 1;
}

message S_ExitPokemonExchangeScene
{
    PlayerInfo exitPlayerInfo = 1;
}


message C_PlayerTalk
{
    int32 playerId = 1;
    TalkRequestType talkRequestType = 2;
}

message S_SendTalkRequest
{
    TalkRequestType talkRequestType = 1;
}

enum TalkRequestType
{
    REQUEST_BATTLE = 0;
    REQUEST_EXCHANGE = 1;
    ACCEPT_BATTLE = 2;
    ACCEPT_EXCHANGE = 3;
    REJECT = 4;
    CANCEL_TALK = 5;
}




// 가방 씬
message CategoryInventory
{
    repeated ItemSummary categoryItemSums = 1;
}




// 포켓몬 진화 씬
message C_PokemonEvolution
{
    int32 playerId = 1;
    bool isEvolution = 2;
}

message S_PokemonEvolution
{
    PokemonSummary evolvePokemonSum = 1;
    PokemonMoveSummary newMoveSum = 2;
}

enum CreatureState {
    NoneState = 0;
    Idle = 1;
    ChangeDir = 2;
    Walk = 3;
    Run = 4;
    WatchMenu = 5;
    Fight = 6;
    Talk = 7;
    Exchanging = 8;
    PokemonEvolving = 9;
    Shopping = 10;

    // Nurse
    NurseThankYou = 11;
}

enum MoveDir {
  Up = 0;
  Down = 1;
  Left = 2;
  Right = 3;
}

enum GameObjectType {
  NONE = 0;
  PLAYER = 1;
  POKEMON = 2;
  PROJECTILE = 3;
  NPC = 4;
}

enum NPCType
{
    NoneType = 0;
    SchoolBoy = 1;
}

message OtherPlayerInfo
{
    ObjectInfo objectInfo = 1;
    string playerName = 2;
    PlayerGender playerGender = 3;
}

message PlayerInfo {
    ObjectInfo objectInfo = 1;
    string playerName = 2;
    PlayerGender playerGender = 3;
    int32 money = 4;
    map<int32, CategoryInventory> inventory = 5;
    repeated PokemonSummary pokemonSums = 6;
    string userId = 7;
    string room = 8;
    oneof specialInfo
    {
        NPCInfo npcInfo = 9;
        PlayerInfo playerInfo = 10;
    }
}

message ObjectInfo {
  int32 objectId = 1;
  GameObjectType objectType = 2;
  PositionInfo posInfo = 3;
}

message PositionInfo {
	CreatureState state = 1;
	MoveDir moveDir = 2;
	int32 posX = 3;
	int32 posY = 4;
}

message NPCInfo {
    ObjectInfo objectInfo = 1;
    NPCType npcType = 2;
    string npcName = 3;
}

message ExchangeCursorPos
{
    int32 x = 1;
    int32 y = 2;
}

message PokemonSummary
{
    PokemonInfo pokemonInfo = 1;
    PokemonStat pokemonStat = 2;
    PokemonExpInfo pokemonExpInfo = 3;
    repeated PokemonMoveSummary pokemonMoves = 4;
    PokemonMoveSummary noPPMove = 5;
}

message PokemonInfo
{
    int32 dictionaryNum = 1;
    string nickName = 2;
    string pokemonName = 3;
    // Item ball;
    int32 level = 4;
    PokemonGender gender = 5;

    string ownerName = 6;
    int32 ownerId = 7;
    PokemonType type1 = 8;
    PokemonType type2 = 9;
    PokemonStatusCondition pokemonStatus = 10;

    // Ability ability;

    PokemonNature nature = 11;
    int32 metLevel = 12;
    // string metMapName;
}

message PokemonStat {
	int32 hp = 1;
	int32 maxHp = 2;
	int32 attack = 3;
	int32 defense = 4;
	int32 specialAttack = 5;
	int32 specialDefense = 6;
	int32 speed = 7;
}

message PokemonExpInfo {
    int32 curExp = 1;
    int32 totalExp = 2;
    int32 remainExpToNextLevel = 3;
}

message PokemonMoveSummary
{
    string moveName = 1;
    int32 movePower = 2;
    int32 moveAccuracy = 3;
    float criticalRate = 4;
    int32 curPP = 5;
    int32 maxPP = 6;
    MoveCategory moveCategory = 7;
    PokemonType moveType = 8;
    string moveDescription = 9;
}

message LevelUpStatusDiff
{
    int32 MaxHP = 1;
    int32 Attack = 2;
    int32 Defense = 3;
    int32 SpecialAttack = 4;
    int32 SpecialDefense = 5;
    int32 Speed = 6;
}

enum PlayerGender
{
    PLAYER_MALE = 0;
    PLAYER_FEMALE = 1;
}

enum PokemonGender
{
    MALE = 0;
    FEMALE = 1;
    NEUTRAL = 2;
}

enum PokemonType
{
    NORMAL = 0;
    FIRE = 1;
    WATER = 2;
    ELECTR = 3;
    GRASS = 4;
    FLYING = 5;
    POISON = 6;
    TYPE_NONE = 99;
}

enum PokemonNature
{
    HARDY = 0;
    ADAMANT = 2;
    BOLD = 5;
    DOCILE = 6;
    IMPISH = 7;
    MODEST = 10;
    BASHFUL = 12;
    CALM = 15;
    CAREFUL = 17;
    QUIRKY = 18;
    TIMID = 20;
    JOLLY = 22;
    SERIOUS = 24;
}

enum PokemonStatusCondition
{
    STATUS_NONE = 0;
    FAINTING = 1;
    BURNED = 2;
    FROZEN = 3;
    PARALYZED = 4;
    POISONED = 5;
    SLEPT = 6;
}

enum MoveCategory
{
    PHYSICAL = 0;
    SPECIAL = 1;
    OTHER = 2;
}

enum ItemCategory
{
    Item = 0;
    PokeBall = 1;
    TechnicalMachine = 2;
    Berry = 3;
    KeyItem = 4;
}